# Experiment Configuration

# Dataset
dataset:
  name: cifar10
  batch_size: 128
  num_workers: 2
  pin_memory: true

# Model
model:
  backbone: resnet18
  pretrained: false
  freeze_backbone: true
  num_exits: 4
  exit_channels: [64, 128, 256, 512]

# Training - Exit Classifiers
training_exits:
  epochs: 30
  lr: 0.01
  momentum: 0.9
  weight_decay: 5e-4
  scheduler: cosine
  save_dir: checkpoints/exits

# EM Algorithm
em_routing:
  lambda_val: 0.05
  iterations: 5
  cost_type: linear  # k/4

# Training - Routers
training_routers:
  epochs: 50
  lr: 0.001
  save_dir: checkpoints/routers

# Inference
inference:
  threshold: 0.5
  branchy_threshold: 1.0
